<!-- START doctoc generated TOC please keep comment here to allow auto update -->
<!-- DON'T EDIT THIS SECTION, INSTEAD RE-RUN doctoc TO UPDATE -->
<!-- DON'T EDIT THIS SECTION, INSTEAD RE-RUN doctoc TO UPDATE -->

- [📌 2025 Java 学习计划](#-2025-java-%E5%AD%A6%E4%B9%A0%E8%AE%A1%E5%88%92)
  - [🎯 总体目标](#-%E6%80%BB%E4%BD%93%E7%9B%AE%E6%A0%87)
  - [📅 第一阶段（第 1-4 周）：基础复习与技能提升](#-%E7%AC%AC%E4%B8%80%E9%98%B6%E6%AE%B5%E7%AC%AC-1-4-%E5%91%A8%E5%9F%BA%E7%A1%80%E5%A4%8D%E4%B9%A0%E4%B8%8E%E6%8A%80%E8%83%BD%E6%8F%90%E5%8D%87)
    - [🔖 第 1 周：Java 基础、开发工具与算法快速复习](#-%E7%AC%AC-1-%E5%91%A8java-%E5%9F%BA%E7%A1%80%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7%E4%B8%8E%E7%AE%97%E6%B3%95%E5%BF%AB%E9%80%9F%E5%A4%8D%E4%B9%A0)
      - [☑️ Java 基础（共 3 天）](#-java-%E5%9F%BA%E7%A1%80%E5%85%B1-3-%E5%A4%A9)
      - [☑️ 开发工具（共 1 天）](#-%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7%E5%85%B1-1-%E5%A4%A9)
      - [☑️ 算法基础（贯穿全周）](#-%E7%AE%97%E6%B3%95%E5%9F%BA%E7%A1%80%E8%B4%AF%E7%A9%BF%E5%85%A8%E5%91%A8)
      - [☑️ 英语听力与口语（贯穿全周）](#-%E8%8B%B1%E8%AF%AD%E5%90%AC%E5%8A%9B%E4%B8%8E%E5%8F%A3%E8%AF%AD%E8%B4%AF%E7%A9%BF%E5%85%A8%E5%91%A8)
    - [🔖 第 2 周：Spring 框架、数据库与缓存复习](#-%E7%AC%AC-2-%E5%91%A8spring-%E6%A1%86%E6%9E%B6%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%8E%E7%BC%93%E5%AD%98%E5%A4%8D%E4%B9%A0)
    - [🔖 第 3 周：算法强化与性能优化初步](#-%E7%AC%AC-3-%E5%91%A8%E7%AE%97%E6%B3%95%E5%BC%BA%E5%8C%96%E4%B8%8E%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E5%88%9D%E6%AD%A5)
    - [🔖 第 4 周：英语能力提升与面试准备](#-%E7%AC%AC-4-%E5%91%A8%E8%8B%B1%E8%AF%AD%E8%83%BD%E5%8A%9B%E6%8F%90%E5%8D%87%E4%B8%8E%E9%9D%A2%E8%AF%95%E5%87%86%E5%A4%87)
  - [🚀 第二阶段 Java Cloud-Native Sprint（AWS 专版 · NodeGroup）](#-%E7%AC%AC%E4%BA%8C%E9%98%B6%E6%AE%B5-java-cloud-native-sprintaws-%E4%B8%93%E7%89%88-%C2%B7-nodegroup)
    - [当前进度](#%E5%BD%93%E5%89%8D%E8%BF%9B%E5%BA%A6)
    - [📌 快速导航（进度链接）](#-%E5%BF%AB%E9%80%9F%E5%AF%BC%E8%88%AA%E8%BF%9B%E5%BA%A6%E9%93%BE%E6%8E%A5)
    - [🛡 执行护栏（全阶段通用）](#-%E6%89%A7%E8%A1%8C%E6%8A%A4%E6%A0%8F%E5%85%A8%E9%98%B6%E6%AE%B5%E9%80%9A%E7%94%A8)
    - [🧭 每日执行模板（避免低效 debug）](#-%E6%AF%8F%E6%97%A5%E6%89%A7%E8%A1%8C%E6%A8%A1%E6%9D%BF%E9%81%BF%E5%85%8D%E4%BD%8E%E6%95%88-debug)
    - [📆 时间轴 & 核心交付物](#-%E6%97%B6%E9%97%B4%E8%BD%B4--%E6%A0%B8%E5%BF%83%E4%BA%A4%E4%BB%98%E7%89%A9)
      - [🎯 KPI & 简历映射](#-kpi--%E7%AE%80%E5%8E%86%E6%98%A0%E5%B0%84)
  - [Week 5 — Cloud-Native 微服务上云（EKS）· 可执行清单（Day1–Day5）](#week-5--cloud-native-%E5%BE%AE%E6%9C%8D%E5%8A%A1%E4%B8%8A%E4%BA%91eks%C2%B7-%E5%8F%AF%E6%89%A7%E8%A1%8C%E6%B8%85%E5%8D%95day1day5)
    - [✅ 前置检查（10 分钟）](#-%E5%89%8D%E7%BD%AE%E6%A3%80%E6%9F%A510-%E5%88%86%E9%92%9F)
    - [Day 1｜应用骨架 + Docker 镜像 + 推送 ECR（最小可运行）](#day-1%EF%BD%9C%E5%BA%94%E7%94%A8%E9%AA%A8%E6%9E%B6--docker-%E9%95%9C%E5%83%8F--%E6%8E%A8%E9%80%81-ecr%E6%9C%80%E5%B0%8F%E5%8F%AF%E8%BF%90%E8%A1%8C)
    - [Day 2｜K8s 基础对象（NS/SA/Config/Secret/Deployment/Service）](#day-2%EF%BD%9Ck8s-%E5%9F%BA%E7%A1%80%E5%AF%B9%E8%B1%A1nssaconfigsecretdeploymentservice)
    - [Day 3｜Ingress（ALB）对外暴露 + HPA](#day-3%EF%BD%9Cingressalb%E5%AF%B9%E5%A4%96%E6%9A%B4%E9%9C%B2--hpa)
    - [Day 4｜（可选但高收益）S3 最小接入 + IRSA](#day-4%EF%BD%9C%E5%8F%AF%E9%80%89%E4%BD%86%E9%AB%98%E6%94%B6%E7%9B%8As3-%E6%9C%80%E5%B0%8F%E6%8E%A5%E5%85%A5--irsa)
    - [Day 5｜收尾硬化 + 文档化 + 指标留痕](#day-5%EF%BD%9C%E6%94%B6%E5%B0%BE%E7%A1%AC%E5%8C%96--%E6%96%87%E6%A1%A3%E5%8C%96--%E6%8C%87%E6%A0%87%E7%95%99%E7%97%95)
    - [常见问题与 20 分钟退路](#%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98%E4%B8%8E-20-%E5%88%86%E9%92%9F%E9%80%80%E8%B7%AF)
  - [Week 6](#week-6)

<!-- END doctoc generated TOC please keep comment here to allow auto update -->

# 📌 2025 Java 学习计划

## 🎯 总体目标

系统复习与提升 Java 基础知识、算法能力以及英语综合技能，以顺利通过外企技术面试，达到中高级 Java 开发工程师或 Java 项目技术 Leader 的水平。

---

## 📅 第一阶段（第 1-4 周）：基础复习与技能提升

### 🔖 第 1 周：Java 基础、开发工具与算法快速复习

#### ☑️ Java 基础（共 3 天）

- **Day1: Java 语法与 OOP**
  - 数据类型、控制结构（条件语句、循环）
  - 面向对象基础（封装、继承、多态）

- **Day2: 集合框架与异常处理**
  - 集合框架（List, Set, Map）
  - 异常机制（try-catch、throws、自定义异常）

- **Day3: Java 多线程基础**
  - 线程创建（Thread、Runnable、Callable）
  - 线程池使用（ExecutorService）
  - 线程同步（synchronized、Lock）与线程安全（竞态条件、原子操作）

#### ☑️ 开发工具（共 1 天）

- Git（版本控制与分支管理）
- Maven（项目构建与依赖管理）
- MySQL（基本操作与优化技巧）
- IntelliJ IDEA（基础操作与快捷键）
- Docker（容器化基础使用）

#### ☑️ 算法基础（贯穿全周）

- 每日完成 1-2 道 Leetcode Medium 算法题目练习（数据结构与基础算法）

#### ☑️ 英语听力与口语（贯穿全周）

- 每天收听 30 分钟英文技术播客或视频（如 TechLead）
- 每天英文口语复述算法题或技术知识点，锻炼表达能力

### 🔖 第 2 周：Spring 框架、数据库与缓存复习

- **Day1: Spring 核心**
  - 依赖注入（IOC）、面向切面编程（AOP）
- **Day2: Spring Boot 基础**
  - 自动装配、配置文件、REST API 搭建
- **Day3: Spring Boot 项目实战**
  - 整合数据库、实现业务功能、异常处理
- **Day4: Spring Cloud 微服务入门**
  - Eureka 服务注册、Ribbon 负载均衡、Feign 接口调用
- **Day5: MySQL 优化**
  - 索引优化、SQL 查询优化、慢查询分析
- **Day6: Redis 缓存设计**
  - 缓存场景、缓存设计、缓存击穿/雪崩应对策略
- **Day7: 周总结与项目优化**
  - 项目代码整合与文档编写

### 🔖 第 3 周：算法强化与性能优化初步

| 天次 | 学习主题 | 关键要点 | 主要产出 |
|------|----------|----------|----------|
| **Day 1** | 动态规划基础复盘 | - DP 四步模板<br>- 斐波那契、爬楼梯、01 背包 | 4 道题代码 + `dp-day1.md` 英文总结 |
| **Day 2** | 动态规划进阶 | - 一维压缩、O(n log n) LIS<br>- 最大子数组和（Kadane）<br>- 区间 DP / Bitmask DP 入门 | 5 道题代码 + `dp-day2.md` 英文总结 |
| **Day 3** | 回溯 & 贪心 | - 回溯三步框架 + 剪枝<br>- 组合/全排列/组合总和<br>- 区间贪心（无重叠区间） | 5 道题 + `backtrack-greedy-day3.md` |
| **Day 4** | JVM 内部结构 & GC 原理 | - 堆/Metaspace 布局<br>- G1/ZGC 收集器机制<br>- GC 日志、jstat、VisualVM | `gc_base.log` + `jvm-gc-day4.md` |
| **Day 5** | JVM 性能调优实战 | - 压测 ► 诊断 ► 调参 ► 复测闭环<br>- 参数：堆大小、MaxGCPauseMillis、IHOP | baseline / tuned 报表 + `jvm-tune-report.md` |
| **Day 6** | MySQL 高级优化 & 索引深度 | - 覆盖索引、下推谓词<br>- Buffer Pool 命中率<br>- EXPLAIN JSON / optimizer_trace | 优化前后 EXPLAIN + `mysql-adv-day6.md` |
| **Day 7** | 周整合 & 输出 | - 知识库 & Cheat Sheet<br>- Pull Request：GC/Index 参数合并<br>- 英文周报 ≥ 200 词 + 5 min 算法讲解视频 | `week3-cheatsheet.md` + `week3-report-en.md` + `week4-plan-draft.md` |

### 🔖 第 4 周：英语能力提升与面试准备

- **Day1-Day3: 技术英文阅读与写作**
  - 阅读英文技术文章或书籍（如《Effective Java》）
  - 每天撰写英文技术博客或学习总结
- **Day4-Day5: 模拟技术面试**
  - 每周进行一次英文技术面试模拟
  - 改善英文自我介绍与技术问答表现
- **Day6-Day7: 面试总结与准备强化**
  - 总结本周面试经验与不足，制定针对性改进措施

---

## 🚀 第二阶段 Java Cloud-Native Sprint（AWS 专版 · NodeGroup）

> **执行声明（2025-Stage2 · AWS 专版）**
> - **目标导向**：以**外企 Java 云原生面试**为导向，优先“可讲清楚 + 可演示 + 可量化”，避免陷入低收益 debug。
> - **成本/生命周期原则**：
>   1) 用时开、用完关：**busy=重建，idle=销毁**；
>   2) **单集群多命名空间**，避免多控制面；
>   3) 任何新增资源须满足“**Day-8 一键清理**”。
> - **计划组成**：Week5（微服务上云）→ Week6（观测+韧性）→ Week7（CI/CD+DevOps）→ Week8（Mock+简历）。
> - **产物要求**：每个模块最少 3 个“可截图/可量化”产物 + 一段面试 STAR 故事。

### 当前进度

- Bootcamp **Day 1 ~ Day 3 已完成**（一键重建 / 一键销毁 已验证；Route53 保留 ≈ $0.5/月）。

### 📌 快速导航（进度链接）

- Bootcamp 笔记与操作：`stage2-BootCamp-day0.md` / `stage2-BootCamp-day1*.md` / `stage2-BootCamp-day2*.md`
- 一键重建/销毁脚本：`infra/`（Terraform + 脚本）
- 学习笔记（Google Drive/2025）：按模块对应 Week 5~8

### 🛡 执行护栏（全阶段通用）

- **预算**：总账单 ≤ ¥1,500；常规按需启停 ≈ ¥800（已含缓冲）。
- **计费控制**：EKS 控制面仅上课日开 6h；节点 `t3.small` Spot 混合，夜间 `scale-down-to-0`。
- **安全**：IRSA/OIDC 最小权限，Terraform `backend s3 + dynamodb lock + AES256`，流水线 Trivy 扫描。
- **可观测**：Prom 采样 `sample_limit` 并过滤 `kubelet_*`；CloudWatch Budget（\$80）与告警已开启。
- **清理**：ALB/TG、ECR、S3、DynamoDB、Budget、EKS 全纳入 `cleanup.sh`。

### 🧭 每日执行模板（避免低效 debug）

1) **30min 理论速读**：当天主题的 3–5 个必知点（写入 `notes/YYMMDD.md`）。
2) **90min 关键实操**：只做“面试可讲”的最小闭环（可截图、可复现）。
3) **20min 量化留痕**：把 1–2 个指标/截图落进 README（如 GitOps 成功率、MTTR、Trace 覆盖）。
4) **20min STAR 记录**：一句话补全场景/决策/结果（面试素材）。
5) **Git 提交**：代码、YAML、笔记一并提交；空闲即执行 `destroy`。

> 全流程仅依赖 AWS 账户即可完成；后续若需多云演示，可启用 Terraform GKE provider 再走一遍 Helm / Argo 即可。

### 📆 时间轴 & 核心交付物

| 时段 | 核心主题 & 关键实操 | 主要交付物 |
|------|-------------------|-----------|
| **Day-0 (½ d)** | **Docker & K8s Refresher**<br>· Play-with-Docker：`build / run / push`<br>· Kubernetes Basics 1-3：`kubectl create / expose / scale` | `stage2-BootCamp-day0.md` |
| **Bootcamp 3 d** | **云底座 + IaC**<br>**Day 1** VPC / ALB / IAM 对照（AWS）<br>**Day 2** `eksctl` 创建 **EKS Managed NodeGroup** (Spot t3.small ×2 + OD t3.medium ×1)<br>**Day 3** Terraform 导入 EKS；`backend "s3" + DynamoDB lock + AES256` |
| **Week 5** | **Cloud-Native 微服务上云（EKS）**<br>① Spring Boot 微服务骨架 → Docker 镜像 → 推送 ECR<br>② K8s 基础对象：Namespace / SA(IRSA) / ConfigMap / Secret / Deployment / Service<br>③ Ingress（AWS Load Balancer Controller）+ HPA → 通过 ALB DNS 暴露服务；可选：接入 S3 | 源码仓 + Docker 镜像 Tag<br>K8s YAML/Helm（含 IRSA）<br>ALB DNS 可访问截图 + （可选）S3 读写验证 |
| **Week 6** | **Helm + HPA + Chaos 自愈**<br>· Helm Chart (`charts/task-manager/`)<br>· HPA + PDB + Cluster Autoscaler (Spot 中断容忍)<br>· Chaos Mesh `pod-kill / latency` → **MTTR ≤ 1 min** | Helm 包<br>Chaos 报告 (MTTR & P95) |
| **Week 7-a** | **Observability & SRE**<br>· ADOT Sidecar → **Amazon Managed Prometheus** (采样 `sample_limit: 10000` + **metric_relabel** drop `kubelet_*`)<br>· Grafana Cloud Dash (Free 50 k MTS)<br>· 定义 99.9 % SLO + CloudWatch Composite Alert + Burn-Rate | Trace GIF + Grafana Dash<br>SLO YAML & Post-mortem |
| **Week 7-b** | **生成式 AI Sidecar — Bedrock Titan**<br>· Spring AI + **Titan Text Express** (us-east-1)<br>· Redis Vector / PGVector<br>· CloudWatch + Budget (USD 80) 监控 Token 花费<br>· Spring Retry Exponential-Backoff 限流 | Demo 视频<br>《Bedrock FinOps.md》 |
| **Week 8** | **Mock Marathon & Résumé v2**<br>· Mock-1：Chaos + SLO 深挖 (全英)<br>· Mock-2：AI & 多云系统设计 (全英)<br>· `progress.png`（语速 | filler | MTTR | CI 成功率）<br>· **Day-8 Cleanup** ：`codedeploy cleanup` → `terraform destroy` → `eksctl delete cluster` → 删除 ALB/TG、ECR、S3、DynamoDB、Budget | 两段 90 min 录像 + 评分表<br>`progress.png`<br>简历 v2 PDF |

#### 🎯 KPI & 简历映射

| 指标 | 目标 | 简历措辞示例 |
|------|------|-------------|
| GitOps 发布成功率 | ≥ 98 % | “双链路 GitOps 发布成功率 **98 %+**” |
| Chaos 平均恢复 MTTR | ≤ 1 min | “注入 pod-kill 后平均恢复 **49 s** (业内基线 5 min)” |
| Trace 覆盖率 | ≥ 95 % | “OpenTelemetry 链路覆盖 **95 %** API 请求” |
| 英文 Mock 综合分 | ≥ 4.0 / 5 | “全英文系统设计 Mock 得分 **4.2 / 5**” |

---

## Week 5 — Cloud-Native 微服务上云（EKS）· 可执行清单（Day1–Day5）

> 目标：把一个最小可讲、可演示的 **Spring Boot 微服务** 跑上现有 EKS（NodeGroup），通过 ALB 对外暴露；必要时最小接入 S3（IRSA），并完成可量化产物。
> 原则：**只做最小闭环**（可截图/可复现），遇到卡顿 > 20 分钟走“退路方案”，避免低收益 debug。

### ✅ 前置检查（10 分钟）

- 若集群已销毁：执行现有 **一键重建**（半小时内可起）。
- 设定本周通用变量（bash）：
  ```bash
  export AWS_REGION=ap-southeast-1
  export ECR_REPO=task-manager
  export NS=svc-task
  export APP=task-api
  ```

> 预期产物总表：源码仓（子模块 `apps/task-api`）、ECR 镜像 tag、K8s YAML/Helm、ALB DNS 可访问截图、（可选）S3 读写验证。

### Day 1｜应用骨架 + Docker 镜像 + 推送 ECR（最小可运行）

**做什么**

1. 以 Spring Initializr 生成 `apps/task-api`：Web、Actuator。
2. 提供 2 个端点：`GET /healthz`（返回 `"ok"`）与 `GET /api/tasks`（返回内存列表）。
3. `Dockerfile`（基于 `eclipse-temurin:21-jre`），本地构建，推到 ECR。

**关键命令**

```bash
# 1) 创建 ECR（若你的 Terraform 已有可跳过）
aws ecr create-repository --repository-name $ECR_REPO --region $AWS_REGION 2>/dev/null || true

# 2) 登录 & 构建 & 推送
aws ecr get-login-password --region $AWS_REGION \
| docker login --username AWS --password-stdin $(aws sts get-caller-identity --query Account --output text).dkr.ecr.$AWS_REGION.amazonaws.com

docker build -t $ECR_REPO:0.1.0 ./apps/task-api
docker tag $ECR_REPO:0.1.0 $(aws sts get-caller-identity --query Account --output text).dkr.ecr.$AWS_REGION.amazonaws.com/$ECR_REPO:0.1.0
docker push $(aws sts get-caller-identity --query Account --output text).dkr.ecr.$AWS_REGION.amazonaws.com/$ECR_REPO:0.1.0
```

**产物**：

- `apps/task-api` 源码；`Dockerfile`；ECR 镜像 `:0.1.0` 截图
  **退路**：ECR 推送异常 → 暂用 Docker Hub 公有仓库（只改镜像前缀）。

### Day 2｜K8s 基础对象（NS/SA/Config/Secret/Deployment/Service）

**做什么**

1. 建命名空间与 **IRSA** ServiceAccount（后续可接 S3）。
2. 写最小化 Deployment + ClusterIP Service；加 liveness/readiness probes。
3. 用 ConfigMap 注入 `APP_NAME`、`STAGE=dev` 等。

**YAML 示范（可直接落库 `k8s/base/`）**

```yaml
# ns-sa.yaml
apiVersion: v1
kind: Namespace
metadata: { name: ${NS} }
---
apiVersion: v1
kind: ServiceAccount
metadata:
  name: ${APP}-sa
  namespace: ${NS}
  annotations:
    eks.amazonaws.com/role-arn: arn:aws:iam::<ACCOUNT_ID>:role/${APP}-irsa # 暂可留空，Day4 再补
```

```yaml
# deploy-svc.yaml
apiVersion: v1
kind: ConfigMap
metadata: { name: ${APP}-cm, namespace: ${NS} }
data:
  APP_NAME: "task-api"
  STAGE: "dev"
---
apiVersion: apps/v1
kind: Deployment
metadata: { name: ${APP}, namespace: ${NS} }
spec:
  replicas: 1
  selector: { matchLabels: { app: ${APP} } }
  template:
    metadata: { labels: { app: ${APP} } }
    spec:
      serviceAccountName: ${APP}-sa
      containers:
      - name: ${APP}
        image: <ECR_URI>/${ECR_REPO}:0.1.0
        ports: [{ containerPort: 8080 }]
        envFrom: [{ configMapRef: { name: ${APP}-cm } }]
        readinessProbe: { httpGet: { path: /actuator/health/readiness, port: 8080 }, initialDelaySeconds: 10, periodSeconds: 5 }
        livenessProbe:  { httpGet: { path: /actuator/health/liveness,  port: 8080 }, initialDelaySeconds: 30, periodSeconds: 10 }
---
apiVersion: v1
kind: Service
metadata: { name: ${APP}-svc, namespace: ${NS} }
spec:
  type: ClusterIP
  selector: { app: ${APP} }
  ports: [{ port: 80, targetPort: 8080 }]
```

**关键命令**

```bash
ACCOUNT=$(aws sts get-caller-identity --query Account --output text)
sed -e "s|\${NS}|$NS|g" -e "s|\${APP}|$APP|g" \
    -e "s|\${ECR_REPO}|$ECR_REPO|g" \
    -e "s|\<ACCOUNT_ID\>|$ACCOUNT|g" \
    -e "s|\<ECR_URI\>|$ACCOUNT.dkr.ecr.$AWS_REGION.amazonaws.com|g" \
    k8s/base/*.yaml | kubectl apply -f -
kubectl get pod -n $NS -w
```

**产物**：`kubectl get deploy,svc -n $NS` 截图；就绪 1/1。
**退路**：Probe 失败 → 暂时改为 `/actuator/health`；或放宽 `initialDelaySeconds`。

### Day 3｜Ingress（ALB）对外暴露 + HPA

**做什么**

1. **若尚未安装 AWS Load Balancer Controller**，用已有脚本/Helm 安装（与 OIDC 角色绑定）。
2. 配置 Ingress，自动创建 ALB；设置 HPA 基于 CPU 60%。

**Ingress 示例（`k8s/ingress.yaml`）**

```yaml
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: ${APP}-ing
  namespace: ${NS}
  annotations:
    kubernetes.io/ingress.class: alb
    alb.ingress.kubernetes.io/scheme: internet-facing
    alb.ingress.kubernetes.io/target-type: ip
    alb.ingress.kubernetes.io/healthcheck-path: /actuator/health/readiness
spec:
  rules:
  - http:
      paths:
      - path: /
        pathType: Prefix
        backend: { service: { name: ${APP}-svc, port: { number: 80 } } }
```

**HPA 示例**

```yaml
apiVersion: autoscaling/v2
kind: HorizontalPodAutoscaler
metadata: { name: ${APP}-hpa, namespace: ${NS} }
spec:
  scaleTargetRef: { apiVersion: apps/v1, kind: Deployment, name: ${APP} }
  minReplicas: 1
  maxReplicas: 3
  metrics:
  - type: Resource
    resource: { name: cpu, target: { type: Utilization, averageUtilization: 60 } }
```

**关键命令**

```bash
kubectl apply -f k8s/ingress.yaml
kubectl apply -f k8s/hpa.yaml
# 等待 ALB 创建完成，获取 DNS
kubectl get ingress -n $NS
```

**产物**：ALB DNS 可访问首页/健康检查截图；`kubectl describe hpa` 输出。
**退路**：ALB 迟迟不出 → 检查子网 tag / sg；临时改为 `kubectl port-forward` 验证服务可用性。

### Day 4｜（可选但高收益）S3 最小接入 + IRSA

**做什么**

1. 新建 **S3 bucket**（Terraform 或控制台均可；**Block Public Access**、SSE-S3 开启）。
2. 配置 **IAM 角色**（IRSA）只允许 `bucket/$APP/*` 前缀读写；把 Role 绑定到 `${APP}-sa`。
3. 在应用添加 `/api/files/put?key=...` 与 `/api/files/get?key=...` 两个端点，演示最小读写。

**最小策略示例（`iam/s3-irsa.json`）**

```json
{
  "Version": "2012-10-17",
  "Statement": [{
    "Effect": "Allow",
    "Action": ["s3:PutObject","s3:GetObject"],
    "Resource": "arn:aws:s3:::<BUCKET>/${APP}/*"
  }]
}
```

**验证**

```bash
curl -X POST "http://<ALB_DNS>/api/files/put?key=test.txt" -d 'hello'
curl "http://<ALB_DNS>/api/files/get?key=test.txt"   # 预期返回 hello
```

**产物**：两条 curl 成功截图；应用日志相关片段。
**退路**：若当日遇到卡点 → 暂跳过 S3，保留 IRSA 绑定，Day5 先完成文档与演示。

### Day 5｜收尾硬化 + 文档化 + 指标留痕

**做什么**

1. K8s 资源硬化：为容器加 `requests/limits`，为 ns 增加 `ResourceQuota`（可选），为部署添加 `PodDisruptionBudget`（1）。
2. 输出 **演示脚本**：`demo/start.sh`（apply 所有 YAML）、`demo/stop.sh`（清理除集群外的本周资源；ALB/TG 包含）。
3. README 更新：加入“访问方式、镜像 tag、ALB DNS、（可选）S3 说明、已知限制”。
4. **量化指标**：记录本周 GitOps 发布成功率（若未上 GitOps，记录“部署成功次数/尝试次数”）、HPA 触发截图、平均冷启动时间。
5. **STAR 一句话**：补充到“面试素材”区。

**参考片段**

```yaml
# pdb.yaml
apiVersion: policy/v1
kind: PodDisruptionBudget
metadata: { name: ${APP}-pdb, namespace: ${NS} }
spec:
  minAvailable: 1
  selector: { matchLabels: { app: ${APP} } }
```

**验收清单（打勾即过）**

* [ ] ALB DNS 可稳定访问 `/healthz` 与 `/api/tasks`
* [ ] 部署就绪 1/1（或 HPA 扩展 1→3 后恢复）
* [ ] （可选）S3 PUT/GET 成功
* [ ] README 已更新“部署与访问”与“本周指标”
* [ ] `demo/start.sh` / `demo/stop.sh` 可独立执行
* [ ] 本周截图归档：ECR、Pods、Ingress、HPA、（可选）S3

### 常见问题与 20 分钟退路

* **ECR 登录失败** → 换 Docker Hub 公有仓并继续（后续再切回 ECR）。
* **ALB 不创建** → 先用 `kubectl port-forward svc/${APP}-svc 8080:80` 完成演示；另开 issue 排查子网 tag/控制器。
* **IRSA 无法授权** → 临时改用 `aws configure` 本地测试通过后，再把策略最小化回 IRSA。

> 完成 Week 5 后，即可在面试里完整叙述“**Java 微服务 → 容器化 → EKS 部署 → 通过 ALB 暴露 →（可选）S3 集成**”的闭环，并展示截图与指标作为佐证。

---

## Week 6

TBD
